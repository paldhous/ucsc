<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>Multimedia Journalism: Data Viz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../../css/bootstrap.min.css" rel="stylesheet"> 
  <link href="../../css/custom2.css" rel="stylesheet">
</head>

<body class="markdown github">

	<header class="navbar-inverse navbar-fixed-top">
		<div class="container">
			<nav role="navigation">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a href="index.html" class="navbar-brand">Multimedia Journalism: Data Viz</a>
				</div> <!-- /.navbar-header -->
				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav">
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">Class notes<b class="caret"></b></a>
							<ul class="dropdown-menu">
								<li><a href="principles.html">Basic principles of data analysis and visualization</a></li>
								<li><a href="acquiring-data.html">Finding and downloading data</a></li>
								<li><a href="cleaning-data.html">Processing and cleaning data</a></li>
								<li><a href="basic-charts.html">Basic charts with Plotly</a></li>
								<li><a href="data-processing-r.html">Processing data with R</a></li>
								<li><a href="static-charts-r.html">Static charts with R</a></li>
								<li><a href="interactive-charts-r.html">Interactive charts with R</a></li>
								<li><a href="animations-r.html">Animation: GIFs and videos from R</a></li>
							</ul>
						</li>
						<li>
						<li><a href="software.html">Software</a></li>
						<li><a href="data.html">Data</a></li>
						<li><a href="mailto:p.aldhous@gmail.com">Email instructor</a></li>					
					</ul>
				</div><!-- /.navbar-collapse -->
			</nav>
		</div> <!-- /.navbar-header -->
	</header>

	<div class="container all">

<h1 id="acquiring-data"><a name="acquiring-data" href="#acquiring-data"></a>Acquiring data</h1><p>Not so many years ago, data was hard to obtain. Often journalists would have to painstakingly compile their own datasets from paper records. The Internet has changed the game. Today, many government and other public databases can now be queried online, and the results of those searches downloaded. Other datasets can be downloaded in their entirety.</p><p>The main problem today is usually not finding relevant data, but in working out whether it can be trusted, spotting and correcting errors and inconsistencies, and getting it in the right format for analysis and visualization.</p><p>In this class, we will cover some tips and tricks for finding the data you need online, and getting it onto your computer. We will also review some common data formats, and learn how to convert from one to another.</p><h3 id="understand-common-data-formats"><a name="understand-common-data-formats" href="#understand-common-data-formats"></a>Understand common data formats</h3><p><strong><a href="http://en.wikipedia.org/wiki/Comma-separated_values">CSV</a></strong> is just one variant of a “delimited” text file, in which the fields or columns in a table of data are separated by commas (hence comma-separated values, or CSV) or another character such as a tab. You may also encounter “fixed width” text files, in which the fields are lined up, with each located a specified number of characters across each row. Spreadsheets such as Libre Office Calc or Microsoft Excel can import fixed-width files, which you can then export in a delimited format for use in other software.</p><p>Text files are great for transferring data from one software application to another during analysis and visualisation, but other formats that are easier for machines to read are typically used when transferring data between computers online.</p><p><strong><a href="http://json.org/">JSON</a></strong>, or JavaScript Object Notation, treats data as a series of “objects,” which begin and end with curly brackets. Each object in turn contains a series of name-value pairs. There is a colon between the name and value in each pair, and the pairs separated by commas.</p><p>Here, for example, are the first few rows of a simple dataset relating to a controversial theory claiming that the extent to which a country has developed a democratic political system is driven largely by the historical prevalence of infectious disease:</p><pre class="json hljs"><code class="json" data-origin="<pre><code class=&quot;json&quot;>[{&quot;country&quot;:&quot;Bahrain&quot;,&quot;income_group&quot;:&quot;High income: non-OECD&quot;,&quot;democ_score&quot;:45.6,&quot;infect_rate&quot;:23},
{&quot;country&quot;:&quot;Bahamas, The&quot;,&quot;income_group&quot;:&quot;High income: non-OECD&quot;,&quot;democ_score&quot;:48.4,&quot;infect_rate&quot;:24},
{&quot;country&quot;:&quot;Qatar&quot;,&quot;income_group&quot;:&quot;High income: non-OECD&quot;,&quot;democ_score&quot;:50.4,&quot;infect_rate&quot;:24},
{&quot;country&quot;:&quot;Latvia&quot;,&quot;income_group&quot;:&quot;High income: non-OECD&quot;,&quot;democ_score&quot;:52.8,&quot;infect_rate&quot;:25},
{&quot;country&quot;:&quot;Barbados&quot;,&quot;income_group&quot;:&quot;High income: non-OECD&quot;,&quot;democ_score&quot;:46,&quot;infect_rate&quot;:26}]
</code></pre>">[{"<span class="hljs-attribute">country</span>":<span class="hljs-value"><span class="hljs-string">"Bahrain"</span></span>,"<span class="hljs-attribute">income_group</span>":<span class="hljs-value"><span class="hljs-string">"High income: non-OECD"</span></span>,"<span class="hljs-attribute">democ_score</span>":<span class="hljs-value"><span class="hljs-number">45.6</span></span>,"<span class="hljs-attribute">infect_rate</span>":<span class="hljs-value"><span class="hljs-number">23</span></span>},
{"<span class="hljs-attribute">country</span>":<span class="hljs-value"><span class="hljs-string">"Bahamas, The"</span></span>,"<span class="hljs-attribute">income_group</span>":<span class="hljs-value"><span class="hljs-string">"High income: non-OECD"</span></span>,"<span class="hljs-attribute">democ_score</span>":<span class="hljs-value"><span class="hljs-number">48.4</span></span>,"<span class="hljs-attribute">infect_rate</span>":<span class="hljs-value"><span class="hljs-number">24</span></span>},
{"<span class="hljs-attribute">country</span>":<span class="hljs-value"><span class="hljs-string">"Qatar"</span></span>,"<span class="hljs-attribute">income_group</span>":<span class="hljs-value"><span class="hljs-string">"High income: non-OECD"</span></span>,"<span class="hljs-attribute">democ_score</span>":<span class="hljs-value"><span class="hljs-number">50.4</span></span>,"<span class="hljs-attribute">infect_rate</span>":<span class="hljs-value"><span class="hljs-number">24</span></span>},
{"<span class="hljs-attribute">country</span>":<span class="hljs-value"><span class="hljs-string">"Latvia"</span></span>,"<span class="hljs-attribute">income_group</span>":<span class="hljs-value"><span class="hljs-string">"High income: non-OECD"</span></span>,"<span class="hljs-attribute">democ_score</span>":<span class="hljs-value"><span class="hljs-number">52.8</span></span>,"<span class="hljs-attribute">infect_rate</span>":<span class="hljs-value"><span class="hljs-number">25</span></span>},
{"<span class="hljs-attribute">country</span>":<span class="hljs-value"><span class="hljs-string">"Barbados"</span></span>,"<span class="hljs-attribute">income_group</span>":<span class="hljs-value"><span class="hljs-string">"High income: non-OECD"</span></span>,"<span class="hljs-attribute">democ_score</span>":<span class="hljs-value"><span class="hljs-number">46</span></span>,"<span class="hljs-attribute">infect_rate</span>":<span class="hljs-value"><span class="hljs-number">26</span></span>}]
</code></pre><p><strong><a href="http://www.w3.org/XML/">XML</a></strong>, or Extensible Markup Language, is another format often used to move data around online. For example, the RSS feeds through which you can subscribe to content from blogs and websites using a reader such as <a href="https://feedly.com/">Feedly</a> are formatted in XML.</p><p>In XML data is structured by enclosing values within “tags,” similar to those used to code different elements on a web page in HTML. Here is that same data in XML format:</p><pre class="xml hljs"><code class="xml" data-origin="<pre><code class=&quot;xml&quot;>&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;rows&amp;gt;
  &amp;lt;row country=&quot;Bahrain&quot; income_group=&quot;High income: non-OECD&quot; democ_score=&quot;45.6&quot; infect_rate=&quot;23&quot; &amp;gt;&amp;lt;/row&amp;gt;
  &amp;lt;row country=&quot;Bahamas, The&quot; income_group=&quot;High income: non-OECD&quot; democ_score=&quot;48.4&quot; infect_rate=&quot;24&quot; &amp;gt;&amp;lt;/row&amp;gt;
  &amp;lt;row country=&quot;Qatar&quot; income_group=&quot;High income: non-OECD&quot; democ_score=&quot;50.4&quot; infect_rate=&quot;24&quot; &amp;gt;&amp;lt;/row&amp;gt;
  &amp;lt;row country=&quot;Latvia&quot; income_group=&quot;High income: non-OECD&quot; democ_score=&quot;52.8&quot; infect_rate=&quot;25&quot; &amp;gt;&amp;lt;/row&amp;gt;
  &amp;lt;row country=&quot;Barbados&quot; income_group=&quot;High income: non-OECD&quot; democ_score=&quot;46&quot; infect_rate=&quot;26&quot; &amp;gt;&amp;lt;/row&amp;gt;
&amp;lt;/rows&amp;gt;
</code></pre>"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">rows</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">row</span> <span class="hljs-attribute">country</span>=<span class="hljs-value">"Bahrain"</span> <span class="hljs-attribute">income_group</span>=<span class="hljs-value">"High income: non-OECD"</span> <span class="hljs-attribute">democ_score</span>=<span class="hljs-value">"45.6"</span> <span class="hljs-attribute">infect_rate</span>=<span class="hljs-value">"23"</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">row</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">row</span> <span class="hljs-attribute">country</span>=<span class="hljs-value">"Bahamas, The"</span> <span class="hljs-attribute">income_group</span>=<span class="hljs-value">"High income: non-OECD"</span> <span class="hljs-attribute">democ_score</span>=<span class="hljs-value">"48.4"</span> <span class="hljs-attribute">infect_rate</span>=<span class="hljs-value">"24"</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">row</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">row</span> <span class="hljs-attribute">country</span>=<span class="hljs-value">"Qatar"</span> <span class="hljs-attribute">income_group</span>=<span class="hljs-value">"High income: non-OECD"</span> <span class="hljs-attribute">democ_score</span>=<span class="hljs-value">"50.4"</span> <span class="hljs-attribute">infect_rate</span>=<span class="hljs-value">"24"</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">row</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">row</span> <span class="hljs-attribute">country</span>=<span class="hljs-value">"Latvia"</span> <span class="hljs-attribute">income_group</span>=<span class="hljs-value">"High income: non-OECD"</span> <span class="hljs-attribute">democ_score</span>=<span class="hljs-value">"52.8"</span> <span class="hljs-attribute">infect_rate</span>=<span class="hljs-value">"25"</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">row</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">row</span> <span class="hljs-attribute">country</span>=<span class="hljs-value">"Barbados"</span> <span class="hljs-attribute">income_group</span>=<span class="hljs-value">"High income: non-OECD"</span> <span class="hljs-attribute">democ_score</span>=<span class="hljs-value">"46"</span> <span class="hljs-attribute">infect_rate</span>=<span class="hljs-value">"26"</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">row</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">rows</span>&gt;</span>
</code></pre><h3 id="data-portals"><a name="data-portals" href="#data-portals"></a>Data portals</h3><p>Life is much easier if you can find everything you need in one place. The main effort to centralize access to data by the US federal government is <a href="https://www.data.gov/">Data.gov</a>. You can search for data from the home page, or follow the <a href="https://catalog.data.gov/dataset">Data</a> and Topics links from the top menu.</p><p>Be warned, however, that Data.gov is a work in progress, and does not contain all of the U.S. government’s data. Some of the most useful datasets are still only available on the websites of individual federal agencies. The Federal Committee on Statistical Methodology has <a href="https://nces.ed.gov/FCSM/related_agencies.asp">links to agencies</a> with with some the most important data collections.</p><p>It is worth familiarizing yourself with the main government agencies that have responsibility for the beats you are interested in, and the datasets they maintain.</p><p>Other data portals at various levels of government are emerging. The City and County of San Francisco, for example, was at the forefront of the Open Data movement, establishing <a href="https://data.sfgov.org/">DataSF</a> in 2009.</p><p>If you need to make comparisons between nations, the <a href="https://www.worldbank.org/"><strong>World Bank</strong></a> probably has what you need. Its <a href="https://data.worldbank.org/indicator/?tab=all">World Development Indicators catalog</a> containing data for more than 7,000 different measures, compiled by the bank and other UN agencies.</p><p>You can navigate the site using the search box or using the topics links to the right. When you click on a particular indicator, you are sent to a page that gives options to download the dataset from a link near the top right of the page. The data in some cases goes back as far as 1960, and is listed both by individual country and summarized by regions and income groups.</p><p>Other useful sources of data for international comparisons are <a href="https://www.gapminder.org/data/"><strong>Gapminder</strong></a> and the <strong><a href="https://unstats.un.org/home/">UN Statistical Division</a></strong>. For health data in particular, try the <strong><a href="https://www.oecd.org/els/health-systems/health-data.htm">Organisation for Economic Co-operation and Development</a></strong> and the <strong><a href="https://www.who.int/gho/en/">World Health Organization</a></strong>.</p><h3 id="search-for-data-on-the-web"><a name="search-for-data-on-the-web" href="#search-for-data-on-the-web"></a>Search for data on the web</h3><p>Often, your starting point in searching for data and documents will be Google. It can be worth focusing your queries using Google’s <a href="https://www.google.com/advanced_search">advanced search</a>:</p><p><img src="img/acquiring_data_1.jpg" alt=""></p><p>(Source: <a href="https://www.google.com/advanced_search">Google</a>)</p><p>The options to search by <code>site or domain</code> and <code>file type</code> can be especially useful when looking for data. For example, the <a href="https://www.usgs.gov/">US Geological Survey</a> is the best source of data on earthquakes and seismic risk, so when searching for this information, specifying the domain <code>usgs.gov</code> would be a good idea. You can make the domains as narrow or broad as you like: <code>.edu</code>, for instance, would search the sites of all US academic institutions using that top-level domain; <code>ucsc.edu</code> would search the web pages of this university only.</p><p>The file type search offers a drop-down menu, with the options including Excel spreadsheets, and Google Earth <code>KML</code> and <code>KMZ</code> files. These are common data formats, but you are not limited to those on the menu. In a regular Google search, type a space after your search terms followed by <code>filetype:xxx</code>, where <code>xxx</code> is the suffix for the file type in question. For example, <code>dbf</code> will look for database tables in this format. Combining file type and domain searches can be a good way to find data an agency has posted online — some of which may not otherwise be readily accessible.</p><p>Searching for PDFs and <code>PPT</code> presentations can be a good way to find documents that may not otherwise be easy to find.</p><p>Google has also recently launched <a href="https://toolbox.google.com/datasetsearch">Dataset Search</a>, which aims to simplify the process of finding high-quality datasets, published in standard formats.</p><p>One common data format doesn’t show up file type searches. Geographical data is often made available as “shapefiles.” Because they consist of multiple files that are usually stored in compressed folders, shapefiles can’t readily be searched using a file type suffix, but they can usually be found by adding the terms “shapefile” or “GIS data” to a regular Google search.</p><h3 id="search-online-databases"><a name="search-online-databases" href="#search-online-databases"></a>Search online databases</h3><p>Many important public databases can be searched online, and some offer options to download the results of your queries. Most of these databases give a simple search box, but it’s always worth looking for the advanced search page, which will offer more options to customize your search. Here, for example, is the <a href="https://clinicaltrials.gov/ct2/search/advanced">advanced search</a> page for <a href="https://clinicaltrials.gov/">ClinicalTrials.gov</a>:</p><p><img src="img/acquiring_data_2.jpg" alt=""></p><p>(Source: <a href="https://clinicaltrials.gov/ct2/search/advanced">ClinicalTrials.gov</a>)</p><p>When you start working with a new online database, take some time to familiarize yourself with how its searches work: Read the Help or FAQs, and then run test searches to see what results you obtain. <a href="https://clinicaltrials.gov/ct2/help/how-find/index">Here</a>, for example, is the “How To” section of ClinicalTrials.gov.</p><p>Many online databases can be searched using Boolean logic, using the operators <code>AND</code>, <code>OR</code> and <code>NOT</code> to link search terms together. So find out how a particular database uses Boolean logic — and the default settings that it will use if you list search terms without any Boolean operators.</p><p>Putting search terms in quote marks often searches for a specific phrase. For example, searching for “heart attack” on ClinicalTrials.gov will give only give results in which those two words appear together; leaving out the quote marks will include any trial in which both words appear.</p><p>Also find out whether the database allows “wildcards,” symbols such as <code>*</code> or <code>%</code> that can be dropped into your search to obtain results with variations on a word or number.</p><h3 id="look-for-download-options----and-know-when-you-are-hitting-the-wall"><a name="look-for-download-options----and-know-when-you-are-hitting-the-wall" href="#look-for-download-options----and-know-when-you-are-hitting-the-wall"></a>Look for download options — and know when you are hitting the wall</h3><p>Having run a search on an online database, you will usually want to download the results, so look for the download links or buttons.</p><p>A common problem with online databases, however, is that they may impose limits on the number of results that are returned on each search. And even when a search returns everything, there may be a limit on how many of those results can be downloaded to your own computer.</p><p>If broad searches on a database keep returning the same number of results, that is a sign that you are probably running up against a search limit, and any download will not contain the complete set of data that you are interested in. However, you may be able to work out ways of searching to obtain all of the data in chunks.</p><h3 id="download-the-entire-database"><a name="download-the-entire-database" href="#download-the-entire-database"></a>Download the entire database</h3><p>Downloading an entire database, where this is allowed, frees you from the often-limited options given on an online advanced search form: You can then upload the data into your own data analysis software, and query it in any way that you want.</p><p>So always look for ways to grab all of the data. One trick is to run a search on just the database’s wildcard character, or with the query boxes left blank.</p><p>Other databases have an online search form, but also have a separate link from where data to be downloaded in its entirety, usually as a text file or series of text files. One example is Bioresearch Monitoring Information System, which lists doctors and other researchers involved in testing experimental drugs being considered for marketing approval by the Food and Drug Administration. It can be searched online <a href="https://www.accessdata.fda.gov/scripts/cder/bmis/">here</a>, but can also be downloaded in full from <a href="https://www.fda.gov/drugs/drug-approvals-and-databases/bioresearch-monitoring-information-system-bmis">here</a>.</p><p>Note that large text files are again often stored in compressed folders, so may be invisible to a Google search by file type.</p><h3 id="automate-downloads-of-multiple-data-files"><a name="automate-downloads-of-multiple-data-files" href="#automate-downloads-of-multiple-data-files"></a>Automate downloads of multiple data files</h3><p>Often data or documents don’t reside in a single searchable database, but instead exist online as a series of separate files. In such cases, clicking on each link is tedious and time-consuming. But you can automate the process using the <a href="https://addons.mozilla.org/en-US/firefox/addon/downthemall/">DownThemAll!</a> Firefox add-on.</p><p>Having installed the add-on, navigate in Firefox to this <a href="https://www1.ncdc.noaa.gov/pub/data/ghcn/daily/by_year/">download page</a> for the Global Historical Climatology Network-Daily <a href="https://www.gapminder.org/data/">Gapminder’s data catalog</a>, which allows you to download compressed files for each year’s data.</p><p>Click this icon at top right:</p><p><img src="img/acquiring_data_3.jpg" alt=""></p><p>Then select <code>DownThemAll!</code> to open this window:</p><p><img src="img/acquiring_data_4.jpg" alt=""></p><p>You can select <code>All files</code>, particular file types, or use <code>Fast Filtering</code> to select files by a pattern in their names.</p><p>Enter <code>2***.csv.gz</code> under <code>Fast Filtering</code> to select all data files since 2000 (the asterisks act as wildcards):</p><p><img src="img/acquiring_data_5.jpg" alt=""></p><p>Click <code>Download</code> and all the files should download into the <code>downthemall</code> subfolder of your downloads folder.</p><h3 id="extract-data-from-tables-on-the-web"><a name="extract-data-from-tables-on-the-web" href="#extract-data-from-tables-on-the-web"></a>Extract data from tables on the web</h3><p>On other occasions, data may exist in tables on the web. Copying and pasting data from web tables can be tricky, but the <a href="https://addons.mozilla.org/en-US/firefox/addon/table2clipboard2/">Table 2Clipboard</a> Firefox add-on simplifies the process.</p><p>Having installed the add-on, navigate in Firefox to <a href="https://www.nih.gov/about-nih/what-we-do/nih-almanac/appropriations-section-1">this table</a> showing the budget history for components of the National Institutes of Health.</p><p>Right-click anywhere in the table and select <code>Table2Clipboard&gt;Select table</code>:</p><p><img src="img/acquiring_data_6.jpg" alt=""></p><p>Right-click again and select <code>Table2Clipboard&gt;Copy selected cells</code>. You can now paste the data into a spreadsheet or text file.</p><p>This table is in two parts, so click on the <code>Section 2</code> link, and repeat the process to grab all the data.</p><h3 id="manipulate-urls-to-expose-the-data-you-need"><a name="manipulate-urls-to-expose-the-data-you-need" href="#manipulate-urls-to-expose-the-data-you-need"></a>Manipulate urls to expose the data you need</h3><p>As you search for data using web query forms, make a habit of looking at what happens to the url. Often it will contain patterns detailing the search you have run, and it will be possible to alter the data provided by manipulating the url. This can be quicker than filling in search forms. In some cases it may even reveal more data than default search options will allow.</p><p>To illustrate how this works, go to the <a href="https://www.isrctn.com/">ISRCTN clinical tral registry</a>, and then navigate to the <a href="https://www.isrctn.com/editAdvancedSearch">advanced search page</a>. Enter <code>cancer</code> under <code>Condition</code> and note that more than 2,000 trials are returned.</p><p>The url should now have changed to the following:</p><pre class="javascript hljs"><code class="Javascript" data-origin="<pre><code class=&quot;Javascript&quot;>http://www.isrctn.com/search?q=&amp;amp;filters=condition%3Acancer&amp;amp;searchType=advanced-search
</code></pre>">http:<span class="hljs-comment">//www.isrctn.com/search?q=&amp;filters=condition%3Acancer&amp;searchType=advanced-search</span>
</code></pre><p>Notice that the default is to display 10 results per page, and then change the view to see the maximum of 100 trials allowed by the dropdown menu. The url should now read:</p><pre class="javascript hljs"><code class="Javascript" data-origin="<pre><code class=&quot;Javascript&quot;>http://www.isrctn.com/search?pageSize=100&amp;amp;sort=&amp;amp;page=1&amp;amp;q=&amp;amp;filters=condition%3Acancer&amp;amp;searchType=advanced-search
</code></pre>">http:<span class="hljs-comment">//www.isrctn.com/search?pageSize=100&amp;sort=&amp;page=1&amp;q=&amp;filters=condition%3Acancer&amp;searchType=advanced-search</span>
</code></pre><p>Now change that url to:</p><pre class="javascript hljs"><code class="Javascript" data-origin="<pre><code class=&quot;Javascript&quot;>http://www.isrctn.com/search?pageSize=2500&amp;amp;sort=&amp;amp;page=1&amp;amp;q=&amp;amp;filters=condition%3Acancer&amp;amp;searchType=advanced-search
</code></pre>">http:<span class="hljs-comment">//www.isrctn.com/search?pageSize=2500&amp;sort=&amp;page=1&amp;q=&amp;filters=condition%3Acancer&amp;searchType=advanced-search</span>
</code></pre><p>Having done so, all of the registered clinical trials involving cancer should now be displayed on a single page. We could now use DownThemAll! to download all of the individual web pages describing each of these trials, or we could use this url as the starting point to scrape data from each of those pages.</p><h3 id="use-application-programming-interfaces-(apis)"><a name="use-application-programming-interfaces-(apis)" href="#use-application-programming-interfaces-(apis)"></a>Use application programming interfaces (APIs)</h3><p>Websites like the ISRCTN clinical trial registry are not expressly designed to be searched by manipulating their urls, but some organizations make their data available through APIs that can be queried by constructing a url in a similar way. This allows websites and apps to call in specific chunks of data as required, and work with it “on the fly.”</p><p>To see how this works, go to the US Geological Survey’s <a href="https://earthquake.usgs.gov/earthquakes/search/">Search Earthquake Archives</a> page, where we will search for all earthquakes with a <a href="https://www.geo.mtu.edu/UPSeis/magnitude.html">magnitude</a> of 5 or greater that occured witin 6,000 kilometers of the geographic center of the contiguous United States, which <a href="https://tools.wmflabs.org/geohack/geohack.php?pagename=Geographic_center_of_the_contiguous_United_States&amp;params=39.828175_N_98.579500_W_region:US_type:landmark">this site</a> tells us lies at a latitude of <code>39.828175</code> degrees and a longitude of <code>-98.5795</code> degrees. We will initially ask for the data in a format called <a href="https://geojson.org/">GeoJSON</a> (a variant of JSON, a common format used to trasmit data over the web). Enter <code>1960-01-01T00:00:00</code> under <code>Start</code> for <code>Date &amp; Time</code> boxes so that we obtain all recorded earthquakes from the beginning of 1960 onward. The search form should look like this:</p><p><img src="img/acquiring_data_7.jpg" alt=""></p><p>(Source: <a href="https://earthquake.usgs.gov/earthquakes/search/">U.S. Geological Survey</a>)</p><p>You should recieve a quantity of data at the following url:</p><pre class="javascript hljs"><code class="Javascript" data-origin="<pre><code class=&quot;Javascript&quot;>https://earthquake.usgs.gov/fdsnws/event/1/query?starttime=1960-01-01T00:00:00&amp;amp;latitude=39.828175&amp;amp;longitude=-98.5795&amp;amp;maxradiuskm=6000&amp;amp;minmagnitude=5&amp;amp;format=geojson&amp;amp;orderby=time
</code></pre>">https:<span class="hljs-comment">//earthquake.usgs.gov/fdsnws/event/1/query?starttime=1960-01-01T00:00:00&amp;latitude=39.828175&amp;longitude=-98.5795&amp;maxradiuskm=6000&amp;minmagnitude=5&amp;format=geojson&amp;orderby=time</span>
</code></pre><p>Now replace <code>geojson</code> in the url with <code>csv</code>. The data should now download in CSV format.</p><p><a href="https://earthquake.usgs.gov/fdsnws/event/1/">Here</a> is the full documentation for querying the earthquake API by manipulating these urls.</p><p>Now replace <code>geojson</code> in the url with <code>csv</code>. The data should now download in CSV format.</p><h3 id="scrape-data-from-the-web"><a name="scrape-data-from-the-web" href="#scrape-data-from-the-web"></a>Scrape data from the web</h3><p>Sometimes you will need to compile your own data from information that is spread across a series of webpages, or maintained in a database that doesn’t allow simple downloads of the data or API access. This is where web scraping comes in.</p><p>Using programming languages such as <a href="https://www.r-project.org/">R</a> or <a href="https://www.python.org/">Python</a>, it is possible to write scripts that will pull data down from many webpages, or query web search forms to download an entire database piece by piece.</p><p>Web scraping by coding is beyond the scope of this class. However, the underlying process is simple to understand: Identify the patterns you would need to follow if collecting the data manually, then write a program to automate the process and write the results to a data file. That often means experimenting to reveal the most efficient way of exposing all of the data you require.</p><p>We have already been performing some of the elements of web scraping, by manipulating urls on web search forms and downloading the individual links <em>en masse</em>.</p><p>If you need to scrape data for your visualization project, I should be able to help.</p><h3 id="pdfs:-the-bane-of-data-journalism"><a name="pdfs:-the-bane-of-data-journalism" href="#pdfs:-the-bane-of-data-journalism"></a>PDFs: The bane of data journalism</h3><p>Some organizations persist in making data available as PDFs, rather than text files, spreadsheets or databases. This makes the data hard to extract. While you should always ask for data in a more friendly format — ideally a CSV or other simple text file — you are at some point likely to find yourself needing to pull data out of a PDF.</p><p><strong><a href="https://tabula.technology/">Tabula</a></strong> can extract data from tables in digital PDFS. (To determine if you have a digital PDF, see if you can highlight individual cells within a table. If so, your PDF if digital; if the entire page is highlighted, it is a scanned image, and Tabula will not work.)</p><p>Tabula will not work with PDFs created by scanning the original document as an image, which have to be interpreted using Optical Character Recognition (OCR) software.</p><p><strong><a href="https://acrobat.adobe.com/us/en/products/acrobat-pro.html">Adobe Acrobat Pro</a></strong> will also perform OCR on scanned PDFs.</p><p><strong><a href="https://www.abbyy.com/en-us/finereader/pro-for-mac/">Abby FineReader Pro</a></strong> offers the best quality OCR, in my experience. I have this software, so if you have a difficult OCR job for your project, let me know!</p><p><a href="https://github.com/jsfenfen/parsing-prickly-pdfs">Here</a> is a useful set of resources detailing more advanced tools for dealing with hard-to-parse PDFs.</p><h3 id="further-reading/resources"><a name="further-reading/resources" href="#further-reading/resources"></a>Further reading/resources</h3><p>Paul Bradshaw. <em><a href="https://leanpub.com/scrapingforjournalists">Scraping For Journalists</a></em></p>

	</div> <!-- /.container all -->
	<script src="http://code.jquery.com/jquery.min.js"></script>
	<script src="../../js/bootstrap.min.js"></script>
</body>
</html>
