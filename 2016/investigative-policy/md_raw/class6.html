<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>class6.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.github{padding:20px;font-family:"Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Segoe UI",AppleSDGothicNeo-Medium,'Malgun Gothic',Arial,freesans,sans-serif;font-size:15px;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.github a{color:#3269a0}.github a:hover{color:#4183c4}.github h2{border-bottom:1px solid #e6e6e6;line-height:1.6}.github h6{color:#777}.github hr{border:1px solid #e6e6e6}.github pre>code{font-size:.9em;font-family:Consolas,Inconsolata,Courier,monospace}.github blockquote>code,.github h1>code,.github h2>code,.github h3>code,.github h4>code,.github h5>code,.github h6>code,.github li>code,.github p>code,.github td>code{background-color:rgba(0,0,0,.07);font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;padding:.2em .5em;border:0}.github blockquote{border-left:4px solid #e6e6e6;padding:0 15px;font-style:italic}.github table{background-color:#fafafa}.github table tr td,.github table tr th{border:1px solid #e6e6e6}.github table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#f0f0f0;-webkit-text-size-adjust:none}.hljs,.hljs-subst,.hljs-tag .hljs-title,.nginx .hljs-title{color:#000}.apache .hljs-cbracket,.apache .hljs-tag,.asciidoc .hljs-header,.bash .hljs-variable,.coffeescript .hljs-attribute,.django .hljs-variable,.erlang_repl .hljs-function_or_atom,.haml .hljs-symbol,.hljs-addition,.hljs-constant,.hljs-flow,.hljs-parent,.hljs-pragma,.hljs-preprocessor,.hljs-rules .hljs-value,.hljs-stream,.hljs-string,.hljs-tag .hljs-value,.hljs-template_tag,.hljs-title,.markdown .hljs-header,.ruby .hljs-symbol,.ruby .hljs-symbol .hljs-string,.smalltalk .hljs-class,.tex .hljs-command,.tex .hljs-special{color:#800}.asciidoc .hljs-blockquote,.diff .hljs-header,.hljs-annotation,.hljs-chunk,.hljs-comment,.markdown .hljs-blockquote,.smartquote{color:#888}.asciidoc .hljs-bullet,.asciidoc .hljs-link_url,.go .hljs-constant,.hljs-change,.hljs-date,.hljs-hexcolor,.hljs-literal,.hljs-number,.hljs-regexp,.lasso .hljs-variable,.makefile .hljs-variable,.markdown .hljs-bullet,.markdown .hljs-link_url,.smalltalk .hljs-char,.smalltalk .hljs-symbol{color:#080}.apache .hljs-sqbracket,.asciidoc .hljs-attribute,.asciidoc .hljs-link_label,.clojure .hljs-attribute,.coffeescript .hljs-property,.erlang_repl .hljs-reserved,.haml .hljs-bullet,.hljs-array,.hljs-attr_selector,.hljs-decorator,.hljs-deletion,.hljs-doctype,.hljs-envvar,.hljs-filter .hljs-argument,.hljs-important,.hljs-javadoc,.hljs-label,.hljs-localvars,.hljs-phony,.hljs-pi,.hljs-prompt,.hljs-pseudo,.hljs-shebang,.lasso .hljs-attribute,.markdown .hljs-link_label,.nginx .hljs-built_in,.ruby .hljs-string,.tex .hljs-formula,.vhdl .hljs-attribute{color:#88f}.apache .hljs-tag,.asciidoc .hljs-strong,.bash .hljs-variable,.css .hljs-tag,.hljs-built_in,.hljs-dartdoc,.hljs-id,.hljs-javadoctag,.hljs-keyword,.hljs-phpdoc,.hljs-request,.hljs-status,.hljs-title,.hljs-type,.hljs-typename,.hljs-winutils,.hljs-yardoctag,.markdown .hljs-strong,.smalltalk .hljs-class,.tex .hljs-command{font-weight:700}.asciidoc .hljs-emphasis,.markdown .hljs-emphasis{font-style:italic}.nginx .hljs-built_in{font-weight:400}.coffeescript .javascript,.javascript .xml,.lasso .markup,.tex .hljs-formula,.xml .css,.xml .hljs-cdata,.xml .javascript,.xml .vbscript{opacity:.5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown github">
<h1 id="backgrounding-non-profits,-companies-and-people"><a name="backgrounding-non-profits,-companies-and-people" href="#backgrounding-non-profits,-companies-and-people"></a>Backgrounding non-profits, companies and people</h1><h3 id="non-profits"><a name="non-profits" href="#non-profits"></a>Non-profits</h3><p>In the U.S., non-profit organizations can be considered as charities, exempt from tax, if their activities fall under <a href="http://www.irs.gov/Charities-&amp;-Non-Profits/Charitable-Organizations/Exempt-Purposes-Internal-Revenue-Code-Section-501%28c%29%283%29">exempt purposes</a> specified by the Internal Revenue Service (IRS). These purposes are summarized by the IRS as “charitable, religious, educational, scientific, literary, testing for public safety, fostering national or international amateur sports competition, and preventing cruelty to children or animals.”</p><p>Charities meeting these requirements are known as 501(c)(3) organizations, after the section of the U.S. tax code that governs their operations. As we will see, this includes some organizations with large turnovers. Some organizations have both commercial arms that are treated as for-profits, and non-profit arms that fall under 501(c)(3).</p><p>While 501(c)(3) organizations do not have to pay tax, they do have to submit an annual report to the IRS, known as a Form 990. As a journalist trying to gather basic information on a non-profit, the idiosyncratic Form 990 is your friend.</p><p>There are several versions of this form, with a condensed version for smaller non-profits, see <a href="https://www.irs.gov/Charities-&amp;-Non-Profits/Annual-Electronic-Filing-Requirement-for-Small-Exempt-Organizations-Form-990-N-e-Postcard">here</a>. 501(c)(3) organizations with for-profit arms must file their taxable business income using a form called <a href="http://www.irs.gov/instructions/i990t/">990-T</a>.</p><p>We will consider the full Form 990, also known as 990-EO, filed by organizations with annual earnings of $200,000 or more, and assets of $500,000 or more.</p><p>Two websites provide a good starting point to search for non-profits and view their 990s:</p><h5 id="[guidestar](http://www.guidestar.org/)"><a name="[guidestar](http://www.guidestar.org/)" href="#[guidestar](http://www.guidestar.org/)"></a><a href="http://www.guidestar.org/">Guidestar</a></h5><p>From the homepage, you can search for non-profits by name. The advanced search page is <a href="http://www.guidestar.org/AdvancedSearch.aspx">here</a>. Once on the page for an individual non-profit, for example <a href="http://www.guidestar.org/organizations/53-0196572/american-chemical-society.aspx">here</a> for the American Chemical Society, who will see a green button to the right to download the three most recent 990s:</p><p><img src="img/class6_1.jpg" alt=""></p><p>You will need to <a href="https://www.guidestar.org/Login.aspx">sign up</a> for a free account to view these forms. You can also pay for access to more reports and certain information extracted from them — however, I have never found any need to do this.</p><h5 id="[citizenaudit](https://www.citizenaudit.org/)"><a name="[citizenaudit](https://www.citizenaudit.org/)" href="#[citizenaudit](https://www.citizenaudit.org/)"></a><a href="https://www.citizenaudit.org/">CitizenAudit</a></h5><p>This is a project set up by the data journalist <a href="http://www.lukerosiak.info/">Luke Rosiak</a>, originally with backing from the Sunlight Foundation. It is systematically digitizing 990s using optical character recognition, so that they become fully searchable. So not only can you use the search box on the home page to search for an organization and its 990s, but you can also search the documents for mentions of people, payments from one non-profit to another, and so on. There is a good write-up of its uses in journalism <a href="http://www.icij.org/blog/2013/09/investigating-charities-how-search-finances-nonprofits-and-foundations">here</a>.</p><p>For comparison with Guidestar, <a href="https://www.citizenaudit.org/530196572/">here</a> is the page for the American Chemical Society:</p><p><img src="img/class6_2.jpg" alt=""></p><p>The <code>Tax Documents (Form 990s)</code> tab should have links to 990-EO and 990-T documents going back over 15 years. The most recent ones should habe searchable <strong>Raw text</strong>. (You can also download the scanned PDFs and search them directly in a PDF viewer such as Adobe Acrobat or Preview.)</p><p>When CitizenAudit launched, it was entirely free. It has now become self-supporting, which means that after <a href="https://www.citizenaudit.org/pages/faq/">40 searches or page views</a> from a particular IP address, you will be asked to sign up for a <a href="https://www.citizenaudit.org/accounts/signup/">paid account</a>. This limits its utility, however if you have a project for which you need to gather alot of information on non-profits, and particularly if you need to look at how money passes from one to another, buying a 30-day pass may be a worthwhile option. The full <strong>Funders and Grantees</strong> section, which lists organizations giving and receiving money to the non-profit in question, is only available with a paid account.</p><h5 id="what's-in-a-form-990?"><a name="what's-in-a-form-990?" href="#what's-in-a-form-990?"></a>What’s in a Form 990?</h5><ul>
<li><p><strong>Part I</strong> gives a summary of revenue and expenses over the past two years.</p>
</li><li><p><strong>Part III</strong> gives detail of expenses and revenue on program service — a major, usually ongoing, activity of an organization that accomplishes its tax-exempt purpose.</p>
</li><li><p><strong>Parts IV to VI</strong> contain checklists verifying that the charity meets criteria for tax-exempt status, has appropriate governance and policies etc.</p>
</li><li><p><strong>Part VII</strong> lists and gives compensation for:<br>A) Officers, directors and trustees and key employees.<br>B) Five current highest compensated employees paid more than $100,000.<br>C) Former officers, key employees and highest compensated employees paid more than $100,000.<br>D) Former directors and trustees who received more than $10,000.<br>E) Five highest paid independent contractors paid more than $100,000.</p>
</li><li><p><strong>Part VIII</strong> gives a breakdown of revenue.</p>
</li><li><p><strong>Part IX</strong> gives a breakdown of expenses into major functional categories.</p>
</li><li><p><strong>Part X</strong> is the balance sheet (a friendly accountant can help interpret this and other parts of the form).</p>
</li></ul><p><strong>Schedules of interest:</strong></p><ul>
<li><strong>B</strong> would be of great interest, as it lists major contributors and their donations. But is almost always missing, and if present names can be withheld. But there are often other ways of getting this information — annual reports, plaques in the lobby etc.</li><li><strong>C</strong> documents political campaign and lobbying activities.</li><li><strong>I</strong> documents grants awarded.</li><li><strong>J</strong> has more details on compensation of directors, officers, key employees etc. </li><li><strong>L</strong> Transactions with “interested persons.”</li><li><strong>O</strong> supplemental information, pay attention to this, as it contains the overspill from other parts of the form!</li><li><strong>R</strong> Related organizations.</li></ul><h5 id="an-example-form-990"><a name="an-example-form-990" href="#an-example-form-990"></a>An example Form 990</h5><p>Here is the latest (2014) Form 990 for the American Chemical Society:</p><p>In class, we will use this form to answer the following questions:</p><ul>
<li><p>What was the ACS’s total revenue in 2014?</p>
</li><li><p>What were its total expenses?</p>
</li><li><p>What was its total salary bill?</p>
</li><li><p>What was the highest paid independent contractor?</p>
</li><li><p>Who was the highest paid officer/employee, and how much did they earn?</p>
</li><li><p>How much did the ACS spend on lobbying?</p>
</li></ul><h3 id="companies"><a name="companies" href="#companies"></a>Companies</h3><p>If a company is public, meaning its shares are traded on a stock exchange, then the value of its shares, and the volume of their trading, can provide useful information about its general health, and reveal significant events affecting the company. <a href="http://www.google.com/finance">Google</a> and <a href="http://finance.yahoo.com/">Yahoo</a> both operate finance sites at which you can view these metrics over time.</p><p>In class, we will use Google Finance to explore the history of trading in the stock of Valeant Pharmaceuticals, which has become controversial after <a href="http://www.businessinsider.com/why-have-valeant-pharmaceuticals-shares-collapsed-2015-11">being accused of price gouging</a>.</p><p>At Google Finance, you can view the graphs of stock value and trading volume over various periods (up to ten years), and compare both to <strong>Related companies</strong>, listed below the graph, or standard indices such as the Dow Jones Industrial Average. Companies can be searched by their full names, or by their abbreviated stock market <a href="http://en.wikipedia.org/wiki/Ticker_symbol">ticker</a> — VRX in the case of Valeant.</p><p>Yahoo finance also allows you to download data on the stock value history of companies by constructing urls of the following form:</p><p><strong>Valeant:</strong></p><pre class="sql hljs"><code class="SQL" data-origin="<pre><code class=&quot;SQL&quot;>http://real-chart.finance.yahoo.com/table.csv?s=VRX
</code></pre>">http://real-chart.finance.yahoo.com/table.csv?s=VRX
</code></pre><p><strong>Dow Jones Industrial Average:</strong></p><pre class="sql hljs"><code class="SQL" data-origin="<pre><code class=&quot;SQL&quot;>http://real-chart.finance.yahoo.com/table.csv?s=^DJI
</code></pre>">http://real-chart.finance.yahoo.com/table.csv?s=^DJI
</code></pre><p>Search <a href="http://finance.yahoo.com/lookup">here</a> for the tickers/symbols for companies and indices to use in constructing these urls.</p><h5 id="securities-and-exchange-commission"><a name="securities-and-exchange-commission" href="#securities-and-exchange-commission"></a>Securities and Exchange Commission</h5><p>Public companies are regulated by the <a href="https://www.sec.gov/about/whatwedo.shtml"><strong>Securities and Exchange Commission</strong></a> (SEC), which describes its role as to “protect investors, maintain fair, orderly, and efficient markets, and facilitate capital formation.” Traded companies are obliged to report certain information to the SEC, which you can view by searching for them at the SEC’s main <a href="https://www.sec.gov/edgar/searchedgar/companysearch.html">company search page</a>.</p><p>At the page for each company, you will find its filings to the SEC over time. Here is a guide to the codes for some of the most important documents:</p><ul>
<li><p><strong>10-K</strong> is the annual report, giving  year-end financial statements, a history of the company, legal entanglements, insider conflicts of interest and a detailed management discussion of the company’s prospects. The section marked <strong>Risk Factors</strong> is especially informative. It is where a company describes all the things that might harm its prospects. This is where companies speak the truth that otherwise they would never utter — they do this here because it protects them from being accused by the SEC of misleading investors if they get into serious financial trouble. <a href="https://www.sec.gov/Archives/edgar/data/1076481/000119312510057418/d10k.htm">Here</a> is the 10-K filed for 2009 by the diagnostics company Sequenom, in which this section makes for particularly interesting reading!</p>
</li><li><p><strong>10-Q</strong> is the quarterly financial report.</p>
</li><li><p><strong>DEF 14A</strong> is the proxy statement, which gives salaries, bonuses and stock holdings of top executives. It also gives biographies of some executives and directors, and lists the largest shareholders.</p>
</li><li><p><strong>8-K</strong> announces important breaking news that may affect the stock price. Biomedical companies, for example, will report key results from clinical trials here.</p>
</li><li><p><strong>Form 4 and Schedule 13D</strong> report stock transactions by insiders and key shareholders.</p>
</li></ul><p>You can search for SEC enforcement actions <a href="http://www.sec.gov/litigation.shtml">here</a>. Try searching for Sequenom and see what you find!</p><p><a href="https://searchwww.sec.gov/EDGARFSClient/jsp/EDGAR_MainAccess.jsp">Here</a> is the SEC’s full text search, which can be useful, for example, for finding references to individuals, and privately held companies, in documents filed by publicly traded companies.</p><h5 id="sqoop"><a name="sqoop" href="#sqoop"></a>Sqoop</h5><p><strong><a href="sqoop.com/">Sqoop</a></strong> is a new site that aims to provide a one-stop-shop for information on companies. Sign up for a free account <a href="http://sqoop.com/users/sign_up">here</a>.</p><p>You can search using the names of companies, individual corporate officers, or keywords, and it will return links to SEC filings, Patents and cases in in federal courts. (You will still need a login for the <a href="https://www.pacer.gov/">PACER</a> federal court search system to access federal court documents.)</p><p>Here are the results for a search on Valeant:</p><p><img src="img/class6_3.jpg" alt=""></p><p>You can save a search to receive updates by email of new documents.</p><p>If you are a local reporter, Squoop also provides the option to <a href="http://sqoop.com/blog/2016-03-11-geographic-search">narrow your SEC filing searches by geography</a>. Click on the <code>Locations</code> button after running your search to activate this option.</p><p>Sqoop is currently made freely avilable to journalists, as it tries to expand its user based. It is a for-profit, however, so it is possible that charges will be introduced in future.</p><h5 id="privately-held-companies"><a name="privately-held-companies" href="#privately-held-companies"></a>Privately-held companies</h5><p>It is much harder to do background research on privately-held companies, which do not have to file reports to the SEC. So think about the agencies (state and federal) that have some oversight or regulatory role. For example, a company running animal experiments will have to file reports about its use of animals to the U.S. Department of Agriculture’s Animal and Plant Health Inspection Service, which can be searched <a href="https://acissearch.aphis.usda.gov/LPASearch/faces/CustomerSearch.jspx">here</a>.</p><p>While somewhat dated, <a href="backgrounding_companies.pdf">here</a> is a useful guide to backgrounding privately-held companies.</p><p>In the U.S., companies are registered with the authorities in the state they call home. You can search for businesses registered in California <a href="http://kepler.sos.ca.gov/">here</a>. You can order basic documents about companies’ registration <a href="http://bpd.cdn.sos.ca.gov/pdf/be-records-requests.pdf">using this form</a>.</p><p>But be aware that the name a company trades under may not be its registered name. To find out the registered name, you may need to run a “fictitious business name” search at the county level. <a href="http://sccounty01.co.santa-cruz.ca.us/clerkrecorder/Asp/FBNInquiry.asp">Here</a> is the search site for Santa Cruz County, and <a href="http://www.brbpub.com/">here</a> is useful a site from which you can navigate down to all sorts of public records at state and country levels, including fictitious business name searches.</p><p><a href="https://opencorporates.com/"><strong>OpenCorporates</strong></a> is an ambitious effort to build a database of information on companies throughout the world, public and private.</p><h3 id="people"><a name="people" href="#people"></a>People</h3><p>Searching for information on individual people can be difficult, without access to a commercial research tool such as <a href="http://www.accurint.com/">Accurint</a>. In my experience, most online search sites that offer background checks, contact information, and so on, are more effective at parting you from your money than providing good information.</p><p>Again, it helps to think about official agencies to which individuals must report information. <a href="http://www.reporter.org/desktop/tips/johndoe.htm">Who Is John Doe</a>, a site put togther by investigative reporter <a href="http://www.journalism.columbia.edu/profile/395-duff-wilson/10">Duff Wilson</a>, provides a very useful guide to potential sources of information. <a href="http://www.peoplesearchpro.com/journalism/people/">Here</a> is another site that provides links to various people-searching resources.</p><h1 id="making-maps-with-cartodb"><a name="making-maps-with-cartodb" href="#making-maps-with-cartodb"></a>Making maps with CartoDB</h1><h4 id="the-data-we-will-use"><a name="the-data-we-will-use" href="#the-data-we-will-use"></a>The data we will use</h4><p>Download from <a href="data/mapping.zip">here</a>, unzip the folder and place on your desktop. It contains the following:</p><p><code>mapping</code> Folder containing:</p><ul>
<li><code>oregon_dams_csv</code> Data on dams in Oregon, from the state’s <a href="http://apps.wrd.state.or.us/apps/misc/dam_inventory/">dams inventory</a>.</li><li><code>oregon_seismic_risk</code> Data om seismic risk for the state, <a href="http://earthquake.usgs.gov/hazards/products/conterminous/">calculated by</a> the U.S. Geological Survey.</li></ul><h4 id="getting-started-with-cartodb,-and-uploading-data"><a name="getting-started-with-cartodb,-and-uploading-data" href="#getting-started-with-cartodb,-and-uploading-data"></a>Getting started with CartoDB, and uploading data</h4><p><a href="http://qgis.org/en/site/"><strong>CartoDB</strong></a> is a cloud-based mapping application that makes it easy to produce interactive, online maps. These maps can include <a href="http://docs.cartodb.com/tutorials/introduction_torque.html">animations of data over time</a>. It is also a geospatial database, allowing you to process geodata using Structured Query Language.</p><p>Login to a new CartoDB account, and you should see a screen like this:</p><p><img src="img/cartodb_1.jpg" alt=""></p><p>Open the drop-down menu under <code>Maps</code> at top left and switch to <code>Your datasets</code>. The click the green <code>NEW DATASET</code> button at top right:</p><p><img src="img/cartodb_2.jpg" alt=""></p><p>You should now see the following screen:</p><p><img src="img/cartodb_3.jpg" alt=""></p><p>With the <code>Data file</code> tab selected, click the <code>Browse</code> button, navigate to the zipped <code>oregon_seismic_risk.zip</code> shapefile and click <code>Open</code>. Then click the green <code>Connect dataset</code> button.</p><p>CartoDB can import geodata in a variety of formats, including CSV, <a href="https://developers.google.com/kml/?hl=en">KML</a>, <a href="http://geojson.org/">GeoJSON</a> and zipped <a href="https://en.wikipedia.org/wiki/Shapefile">shapefiles</a>. See <a href="http://docs.cartodb.com/cartodb-editor.html">here</a> for more on imports and supported data formats.</p><p>Once the data has imported, you will see the uploaded data table in <code>DATA VIEW</code>:</p><p><img src="img/cartodb_4.jpg" alt=""></p><p>Notice that, in addition to the fields from the original data, each row has been given a <code>cartodb_id</code>, which is a unique identifier for each. The table also has a field called <code>the_geom</code> which has the tag <code>GEO</code>. This field is central to how CartoDB works, defining the geometry of any map you make. These geometries can be points, lines or polygons (areas) — which is what we have here.</p><p>You can rename fields, sort the table by the data in them, or change their data type (for example from numbers to strings of text), by clicking the downward-pointing triangle next to the header of each.</p><p>The important column in this data is <code>acc_val</code>, which represents the peak ground accelaration expected over 50 years, with a two-percent probability. The numbers are expressed as a percentage of <em>g</em>, the acceleration due to gravity.</p><p>Switch to <code>MAP VIEW</code> to see the basic, unstyled map:</p><p><img src="img/cartodb_5.jpg" alt=""></p><p>Click the small return arrow at top left to go back to the overview of your datasets.</p><p>Notice that the top menu has a link to <code>DOCUMENTATION</code>, which has links to CartoDB’s technical manuals. The <code>Data library</code> link contains useful datasets that you can import into your own account. Take a few minutes to explore what’s there, before returning to your <code>Datasets</code>.</p><p>Now click the <code>NEW DATASET</code> button again and import the file <code>oregon_dams.csv</code>, which should look like this in the <code>DATA VIEW</code>:</p><p><img src="img/cartodb_6.jpg" alt=""></p><p>Notice that <code>the_geom</code> for points is given by their longitude and latitude co-ordinates.</p><p>Notice that there is a column called <code>hazard</code>, with valaues of <code>H</code> for high, <code>S</code> for significant, and <code>L</code> for low. <code>H</code> means a dam could cause loss of human life if it failed; <code>S</code> means failure could cause significant economic or environmental damage. However, these ratings do not mean that a dam is <em>likely</em> to fail.</p><p>Click on the <code>MAP VIEW</code> to see the locations of all of the dams:</p><p><img src="img/cartodb_7.jpg" alt=""></p><h4 id="run-a-sql-query-to-select-potentially-hazardous-dams-in-high-seismic-risk-zones"><a name="run-a-sql-query-to-select-potentially-hazardous-dams-in-high-seismic-risk-zones" href="#run-a-sql-query-to-select-potentially-hazardous-dams-in-high-seismic-risk-zones"></a>Run a SQL query to select potentially hazardous dams in high seismic risk zones</h4><p>We will now run the following query, to filter the dams to return those with a hazard rating of <code>H</code> or <code>S</code> only in the zones of highest seismic risk, where <code>acc_val</code> is <code>40</code> or more:</p><pre class="sql hljs"><code class="SQL" data-origin="<pre><code class=&quot;SQL&quot;>SELECT oregon_dams.*
FROM oregon_dams, oregon_seismic_risk
WHERE ST_WITHIN(oregon_dams.the_geom, oregon_seismic_risk.the_geom) AND oregon_seismic_risk.acc_val &amp;gt;= 40 AND (oregon_dams.hazard = 'H' OR oregon_dams.hazard='S')
</code></pre>"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> oregon_dams.*
<span class="hljs-keyword">FROM</span> oregon_dams, oregon_seismic_risk
<span class="hljs-keyword">WHERE</span> ST_WITHIN(oregon_dams.the_geom, oregon_seismic_risk.the_geom) <span class="hljs-keyword">AND</span> oregon_seismic_risk.acc_val &gt;= <span class="hljs-number">40</span> <span class="hljs-keyword">AND</span> (oregon_dams.hazard = <span class="hljs-string">'H'</span> <span class="hljs-keyword">OR</span> oregon_dams.hazard=<span class="hljs-string">'S'</span>)
</span></code></pre><p>CartoDB is based on a <a href="http://www.postgresql.org/">PostgreSQL</a> database. It works similarly to SQLite, although the syntax for some queries is a little different. <a href="http://www.postgresqltutorial.com/">Here</a> is a PostgreSQL tutorial, if you would like to learn more.</p><p>Importantly, CartoDB allows you you run spatial/grographic queries using an extension to PostgreSQL called <a href="http://postgis.net/">PostGIS</a>. PostGIS functions can, for instance, calculate distances or areas, and all begin with the prefix <code>ST_</code>. See <a href="http://postgis.net/docs/manual-2.2/PostGIS_Special_Functions_Index.html">here</a> for a full list of PostGIS special functions.</p><p>The query above uses <code>ST_Within</code> (see <a href="http://postgis.net/docs/manual-2.2/ST_Within.html">here</a>) to select everything from the <code>oregon_dams</code> dataset where the geometry for those points falls within the geometry of the <code>oregon_seismic_risk</code> zones, if <code>acc_val</code> is 40 or more. When running a query like this, referencing <code>the_geom</code> from two datasets/tables, both tables must appear in the <code>FROM</code> clause, separated by a comma.</p><p>Click <code>Apply query</code> and you will be prompted to <code>create dataset from query</code>. Click on this link, and rename the new dataset as <code>oregon_dams_hazard</code> by clicking on its name at top left.</p><p>Select the <code>MAP VIEW</code> to see the filtered dataset on a map:</p><p><img src="img/cartodb_8.jpg" alt=""></p><h4 id="create-a-map-combining-two-datasets"><a name="create-a-map-combining-two-datasets" href="#create-a-map-combining-two-datasets"></a>Create a map combining two datasets</h4><p>Exit this map and reopen the <code>oregon_seismic_risk</code> dataset. Then click the <code>VISUALIZE</code> button at top right.</p><p>You will then see a prompt to create a new map. Click the green <code>OK, CREATE MAP</code> button. Rename this map <code>oregon_seismic_dams</code> by clicking on its name at top left.</p><p>Now add <code>oregon_dams_hazard</code> to the map, by clicking on the blue <code>+</code> button to the right. At the dialog box, select the <code>oregon_dams</code> dataset and click the <code>ADD LAYER</code> button.</p><p>Now select <code>MAP VIEW</code> to see both layers on the same map:</p><p><img src="img/cartodb_9.jpg" alt=""></p><h4 id="select-a-basemap"><a name="select-a-basemap" href="#select-a-basemap"></a>Select a basemap</h4><p>Close the panel at bottom left suggesting interesting maps.</p><p>Now choose a basemap for your visualization, by clicking <code>Select basemap</code> at bottom left. Take a few minutes to explore the built-in basemap options.</p><h4 id="style-the-maps-using-the-cartodb-wizard"><a name="style-the-maps-using-the-cartodb-wizard" href="#style-the-maps-using-the-cartodb-wizard"></a>Style the maps using the CartoDB wizard</h4><p>Notice that the toolbar at right has tabs numbered <code>1</code> and <code>2</code>. It you hover over them, you will see that they correspond to the <code>oregon_seismic_risk</code> and <code>oregon_dams_hazard</code> layers respectively.</p><p>Click on <code>1</code> to expose the <code>Map layer wizard</code> for the <code>oregon_seismic_risk</code> layer, which can also be reached by clicking the paintbrush icon:</p><p><img src="img/cartodb_10.jpg" alt=""></p><p>(You can collapse the wizards at any time by clicking to the left of any of the icons.)</p><p>Notice that opening the wizard has also exposed blue toggle controls for each layer, which can be used to turn the visibility for each on and off. Hide the <code>oregon_dams_hazard</code> layer so we can see what we are doing.</p><p>Scroll from left to right through the visualization options, and select <code>CHOROPLETH</code> to make a map where larger values for seismic risk correspond to more intense colors</p><p>Set <code>acc_val</code> as the data <code>Column</code>, select <code>5 Buckets</code>, and set them by <code>Quantile</code>. The map should now look like this:</p><p><img src="img/cartodb_11.jpg" alt=""></p><p>Now click <code>2</code> to switch to the <code>oregon_dams_hazard</code> layer, and turn on its visibility.</p><p>In the <code>Map layer wizard</code>, select <code>CATEGORY</code> and color the circles by their hazard level, by selecting <code>hazard</code> as the data <code>Column</code>. The map should now look like this:</p><p><img src="img/cartodb_12.jpg" alt=""></p><p>Go back into the <code>Map layer</code> wizard and manually edit the colors, by clicking on the colored boxes, selecting new colors so that high risk dams are emphasized with a more intense color:</p><p><img src="img/cartodb_13.jpg" alt=""></p><h4 id="edit-the-legend"><a name="edit-the-legend" href="#edit-the-legend"></a>Edit the legend</h4><p>The meaning of legend will not immediately be obvious to someone who does not know what the numbers mean, and what <code>H</code> and <code>S</code> refer to.</p><p>For the <code>oregon_dams_hard</code> layer, click on the legend icon:</p><p><img src="img/cartodb_14.jpg" alt=""></p><p>Change the <code>Title</code> from <code>empty</code> to <code>Dam hazard</code>:</p><p><img src="img/cartodb_15.jpg" alt=""></p><p>Now click on the <code>&lt;/&gt;</code> link to the HTML for the legend, and edit to the following, and click <code>Apply</code>:</p><pre class="css hljs"><code class="CSS" data-origin="<pre><code class=&quot;CSS&quot;>&amp;lt;div class='cartodb-legend category'&amp;gt;    
&amp;lt;div class=&quot;legend-title&quot;&amp;gt;Dam hazard&amp;lt;/div&amp;gt;
&amp;lt;ul&amp;gt;
    &amp;lt;li&amp;gt;
        &amp;lt;div class=&quot;bullet&quot; style=&quot;background: #0F3B82&quot;&amp;gt;&amp;lt;/div&amp;gt; High
    &amp;lt;/li&amp;gt;
    &amp;lt;li&amp;gt;
        &amp;lt;div class=&quot;bullet&quot; style=&quot;background: #5CA2D1&quot;&amp;gt;&amp;lt;/div&amp;gt; Significant
    &amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
&amp;lt;/div&amp;gt;
</code></pre>">&lt;div class='cartodb-legend category'&gt;    
&lt;div class="legend-title"&gt;Dam hazard&lt;/div&gt;
&lt;ul&gt;
    &lt;li&gt;
        &lt;div class="bullet" style="background: #0F3B82"&gt;&lt;/div&gt; High
    &lt;/li&gt;
    &lt;li&gt;
        &lt;div class="bullet" style="background: #5CA2D1"&gt;&lt;/div&gt; Significant
    &lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</code></pre><p>Edit the legend for the <code>oregon_seismic_risk</code> layer, adding <code>Seismic risk</code> for title, and replacing the numbers for <code>Left label</code> and <code>Right label</code> with <code>Low</code> and <code>High</code>.  Click <code>Apply</code> and the map should look like this:</p><p><img src="img/cartodb_16.jpg" alt=""></p><h4 id="configure-tooltips"><a name="configure-tooltips" href="#configure-tooltips"></a>Configure tooltips</h4><p>Select the <code>oregon_dams_hazard</code> layer, and click the infowindow icon:</p><p><img src="img/cartodb_17.jpg" alt=""></p><p>In the <code>Hover</code> tab, select the <code>dam_name</code> toggle control, and uncheck <code>title</code>. Now the dam’s name should appear when you hover over each point.</p><h4 id="configure-the-map-options,-and-publish"><a name="configure-the-map-options,-and-publish" href="#configure-the-map-options,-and-publish"></a>Configure the map options, and publish</h4><p>We are almost ready to publish the map, but before doing so, click <code>Options</code> at the bottom left of the map to select the controls and other items you want to include. Here  the <code>Search box</code>, which geocodes locations entered by the user and zooms to them, is disabled; the option to switch to a <code>Fullscreen</code> view of the map is enabled:</p><p><img src="img/cartodb_18.jpg" alt=""></p><p>Also explore the <code>Add Element</code> button at top left, which allows you to add a title and other annotations to your map.</p><p>Having finished working on the visualization, click the <code>PUBLISH</code> button at top right. This will call up the following options:</p><p><img src="img/cartodb_19.jpg" alt=""></p><p>Copy the code from <code>Embed it</code> to obtain an <a href="http://www.w3schools.com/tags/tag_iframe.asp">iframe</a> which will allow you to embed the map on any web page, in the following format:</p><pre class="css hljs"><code class="CSS" data-origin="<pre><code class=&quot;CSS&quot;>&amp;lt;iframe width=&quot;100%&quot; height=&quot;520&quot; frameborder=&quot;0&quot; src=&quot;https://ucbdataviz.cartodb.com/viz/4330edb0-0f24-11e6-b1df-0e5db1731f59/embed_map&quot; allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen&amp;gt;&amp;lt;/iframe&amp;gt;
</code></pre>">&lt;iframe width="100%" height="520" frameborder="0" src="https://ucbdataviz.cartodb.com/viz/4330edb0-0f24-11e6-b1df-0e5db1731f59/embed_map" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen&gt;&lt;/iframe&gt;
</code></pre><p>(Note that you can edit the dimensions of the iframe — here set at <code>100%</code> of the width of the div in which it appears — and <code>520</code> pixels high) as required.)</p><h4 id="further-reading/resources"><a name="further-reading/resources" href="#further-reading/resources"></a>Further reading/resources</h4><p><a href="http://docs.cartodb.com/tutorials.html">CartoDB tutorials</a></p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
