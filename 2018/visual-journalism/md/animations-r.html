<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>animations-r.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.github{padding:20px;font-family:"Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Segoe UI",AppleSDGothicNeo-Medium,'Malgun Gothic',Arial,freesans,sans-serif;font-size:15px;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.github a{color:#3269a0}.github a:hover{color:#4183c4}.github h2{border-bottom:1px solid #e6e6e6;line-height:1.6}.github h6{color:#777}.github hr{border:1px solid #e6e6e6}.github pre>code{font-size:.9em;font-family:Consolas,Inconsolata,Courier,monospace}.github blockquote>code,.github h1>code,.github h2>code,.github h3>code,.github h4>code,.github h5>code,.github h6>code,.github li>code,.github p>code,.github td>code{background-color:rgba(0,0,0,.07);font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;padding:.2em .5em;border:0}.github blockquote{border-left:4px solid #e6e6e6;padding:0 15px;font-style:italic}.github table{background-color:#fafafa}.github table tr td,.github table tr th{border:1px solid #e6e6e6}.github table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-dartdoc,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-type,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown github">
<h1 id="animation:-making-gifs-and-videos-from-r"><a name="animation:-making-gifs-and-videos-from-r" href="#animation:-making-gifs-and-videos-from-r"></a>Animation: making GIFs and videos from R</h1><p>In today’s class, we will make animated GIFs and videos from charts made in R using <strong>ggplot2</strong>. This depends on connecting R to two software libraries, <a href="http://imagemagick.org/script/index.php"><strong>ImageMagick</strong></a> (for processing images, including GIFs), and <strong><a href="http://ffmpeg.org/">FFmpeg</a></strong> (for processing video). See the <a href="software.html">software</a> page for installation instructions.</p><h3 id="the-data-we-will-use-today"><a name="the-data-we-will-use-today" href="#the-data-we-will-use-today"></a>The data we will use today</h3><p>Download the data for this session from <a href="data/animations-r.zip">here</a>, unzip the folder and place it on your desktop. It contains the following file:</p><ul>
<li><code>nations.csv</code> Data from the World Bank Indicators portal, as used previously.</li></ul><h3 id="setting-up"><a name="setting-up" href="#setting-up"></a>Setting up</h3><p>Launch RStudio, create a new RScript, and set the working directory to the folder with your downloaded data by selecting <code>Session&gt;Set Working Directory&gt;To Source File Location</code>. Save the script as <code>animations.R</code>.</p><h4 id="install-devtools-and-gganimate-packages"><a name="install-devtools-and-gganimate-packages" href="#install-devtools-and-gganimate-packages"></a>Install devtools and gganimate packages</h4><p>Today, we are going to animate <strong>ggplot2</strong> graphics using the <strong><a href="https://github.com/dgrtwo/gganimate">gganimate</a></strong> package, which is an <a href="http://www.ggplot2-exts.org/">extension</a> to <strong>ggplot2</strong>. It depends upon ImageMagick and FFmpeg to make GIFs and videos.</p><p><strong>gganimate</strong> is available on GitHub. To install from there, you first need to install the <a href="https://github.com/hadley/devtools"><strong>devtools</strong></a> package.</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># load devtools
library(devtools)

# install gganimate
install_github(&quot;dgrtwo/gganimate&quot;)
</code></pre>"><span class="hljs-comment"># load devtools</span>
<span class="hljs-keyword">library</span>(devtools)

<span class="hljs-comment"># install gganimate</span>
install_github(<span class="hljs-string">"dgrtwo/gganimate"</span>)
</code></pre><h4 id="load-the-packages-we-will-use-today"><a name="load-the-packages-we-will-use-today" href="#load-the-packages-we-will-use-today"></a>Load the packages we will use today</h4><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># load required packages
library(readr)
library(ggplot2)
library(gganimate)
library(scales)
library(dplyr)
</code></pre>"><span class="hljs-comment"># load required packages</span>
<span class="hljs-keyword">library</span>(readr)
<span class="hljs-keyword">library</span>(ggplot2)
<span class="hljs-keyword">library</span>(gganimate)
<span class="hljs-keyword">library</span>(scales)
<span class="hljs-keyword">library</span>(dplyr)
</code></pre><p>Apart from <strong>gganimate</strong>, we have encountered all of these packages in previous classes.</p><h3 id="make-a-gapminder-style-animated-bubble-chart"><a name="make-a-gapminder-style-animated-bubble-chart" href="#make-a-gapminder-style-animated-bubble-chart"></a>Make a Gapminder-style animated bubble chart</h3><p>In our first class with <strong>ggplot2</strong>, we made the following chart, showing GDP per capita, life expectancy at birth and population for the world’s nations in 2015:</p><p><img src="img/animations_1.png" alt=""></p><p>This is the code to generate that chart:</p><pre class="r hljs"><code class="r" data-origin="<pre><code class=&quot;r&quot;># load data
nations &amp;lt;- read_csv(&quot;nations.csv&quot;)

# filter for 2015 data only
nations2015 &amp;lt;- nations %&amp;gt;%
  filter(year == 2015)

# make bubble chart
ggplot(nations2015, aes(x = gdp_percap, y = life_expect)) +
  xlab(&quot;GDP per capita&quot;) +
  ylab(&quot;Life expectancy at birth&quot;) +
  theme_minimal(base_size = 14) +
  geom_point(aes(size = population, color = region), alpha = 0.7) +
  scale_size_area(guide = FALSE, max_size = 15) +
  scale_x_continuous(labels = dollar) +
  stat_smooth(formula = y ~ log10(x), se = FALSE, size = 0.5, color = &quot;black&quot;, linetype=&quot;dotted&quot;) +
  scale_color_brewer(name = &quot;&quot;, palette = &quot;Set2&quot;) +
  theme(legend.position=c(0.8,0.4))
</code></pre>"><span class="hljs-comment"># load data</span>
nations &lt;- read_csv(<span class="hljs-string">"nations.csv"</span>)

<span class="hljs-comment"># filter for 2015 data only</span>
nations2015 &lt;- nations %&gt;%
  filter(year == <span class="hljs-number">2015</span>)

<span class="hljs-comment"># make bubble chart</span>
ggplot(nations2015, aes(x = gdp_percap, y = life_expect)) +
  xlab(<span class="hljs-string">"GDP per capita"</span>) +
  ylab(<span class="hljs-string">"Life expectancy at birth"</span>) +
  theme_minimal(base_size = <span class="hljs-number">14</span>) +
  geom_point(aes(size = population, color = region), alpha = <span class="hljs-number">0.7</span>) +
  scale_size_area(guide = <span class="hljs-literal">FALSE</span>, max_size = <span class="hljs-number">15</span>) +
  scale_x_continuous(labels = dollar) +
  stat_smooth(formula = y ~ log10(x), se = <span class="hljs-literal">FALSE</span>, size = <span class="hljs-number">0.5</span>, color = <span class="hljs-string">"black"</span>, linetype=<span class="hljs-string">"dotted"</span>) +
  scale_color_brewer(name = <span class="hljs-string">""</span>, palette = <span class="hljs-string">"Set2"</span>) +
  theme(legend.position=c(<span class="hljs-number">0.8</span>,<span class="hljs-number">0.4</span>))
</code></pre><p>Some reminders about what this code does:</p><ul>
<li><p><code>scale_size_area</code> ensures that the size of the circles scales by their area according to the population data, up to the specified <code>max_size</code>; <code>guide = FALSE</code> within the parentheses of this function prevents a legend for size being drawn.</p>
</li><li><p><code>labels = dollar</code> from <strong>scales</strong> formats the X axis labels as currency in dollars.</p>
</li><li><p><code>stat_smooth</code> works like <code>geom_smooth</code> but allows you to use a <code>formula</code> to specify the type of curve to use for the trend line fitted to the data, here a logarithmic curve.</p>
</li></ul><p>Now we will use <strong>gganimate</strong> to generate an animation of the chart, from 1990 to 2015. Here is the code:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;>nations_chart &amp;lt;- ggplot(nations, aes(x = gdp_percap, y = life_expect, frame = year)) +
  xlab(&quot;GDP per capita&quot;) +
  ylab(&quot;Life expectancy at birth&quot;) +
  theme_minimal(base_size = 16) +
  geom_point(aes(size = population, color = region), alpha = 0.7) +
  scale_size_area(guide = FALSE, max_size = 20) +
  scale_x_continuous(labels = dollar) +
  stat_smooth(aes(group = year), formula = y ~ log10(x), se = FALSE, size = 0.5, color = &quot;black&quot;, linetype=&quot;dotted&quot;) +
  scale_color_brewer(name = &quot;&quot;, palette = &quot;Set2&quot;) +
  theme(legend.position=c(0.8,0.4))
</code></pre>">nations_chart &lt;- ggplot(nations, aes(x = gdp_percap, y = life_expect, frame = year)) +
  xlab(<span class="hljs-string">"GDP per capita"</span>) +
  ylab(<span class="hljs-string">"Life expectancy at birth"</span>) +
  theme_minimal(base_size = <span class="hljs-number">16</span>) +
  geom_point(aes(size = population, color = region), alpha = <span class="hljs-number">0.7</span>) +
  scale_size_area(guide = <span class="hljs-literal">FALSE</span>, max_size = <span class="hljs-number">20</span>) +
  scale_x_continuous(labels = dollar) +
  stat_smooth(aes(group = year), formula = y ~ log10(x), se = <span class="hljs-literal">FALSE</span>, size = <span class="hljs-number">0.5</span>, color = <span class="hljs-string">"black"</span>, linetype=<span class="hljs-string">"dotted"</span>) +
  scale_color_brewer(name = <span class="hljs-string">""</span>, palette = <span class="hljs-string">"Set2"</span>) +
  theme(legend.position=c(<span class="hljs-number">0.8</span>,<span class="hljs-number">0.4</span>))
</code></pre><p>Running this code will create an R object of type <code>gg</code> called <code>nations_chart</code>.</p><p>Now display it in the <code>Viewer</code> panel by running the following:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;>gganimate(nations_chart)
</code></pre>">gganimate(nations_chart)
</code></pre><p>This should be the result:</p><p><img src="img/nations.gif" alt=""></p><h4 id="how-the-code-works"><a name="how-the-code-works" href="#how-the-code-works"></a>How the code works</h4><p>I made a couple of small changes to the <strong>ggplot2</strong> code from the static graphic to optimise the appearance of the animation, increasing both the <code>base_size</code> for the text, and the <code>max_size</code> for the scaled circles.</p><p>The most important change, however, is in the initial <code>ggplot</code> function, which now includes <code>frame = year</code>. In the animation, this is the code that creates a separate chart for each year in the data.</p><p>Also notice that the code that creates the trend line now includes <code>aes(group = year)</code>. This is needed if we want to create a separate trend line for each year. Without this, a single trend line would be calculated for all the data across all the years, and would be static across the animation.</p><h4 id="save-as-a-gif-and-a-video"><a name="save-as-a-gif-and-a-video" href="#save-as-a-gif-and-a-video"></a>Save as a GIF and a video</h4><p>Having made an animation, we can now save it as a GIF or a video:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># save as a GIF
gganimate(nations_chart, &quot;nations.gif&quot;, ani.width = 750, ani.height = 450, interval = 0.2)

# save as a video 
gganimate(nations_chart, &quot;nations.mp4&quot;, ani.width = 800, ani.height = 450, interval = 0.1)
</code></pre>"><span class="hljs-comment"># save as a GIF</span>
gganimate(nations_chart, <span class="hljs-string">"nations.gif"</span>, ani.width = <span class="hljs-number">750</span>, ani.height = <span class="hljs-number">450</span>, interval = <span class="hljs-number">0.2</span>)

<span class="hljs-comment"># save as a video </span>
gganimate(nations_chart, <span class="hljs-string">"nations.mp4"</span>, ani.width = <span class="hljs-number">800</span>, ani.height = <span class="hljs-number">450</span>, interval = <span class="hljs-number">0.1</span>)
</code></pre><p>You can use the options <code>ani.width</code> and <code>ani.height</code> to set the dimensions, in pixels, of the animation; <code>interval</code> sets the interval between the frames, in seconds (the default is 1 second). For the video, I have set the ratio between width and height at 16:9, consistent with YouTube format.</p><p>Here is the video:</p><div class="embed-responsive embed-responsive-16by9"><br>    <iframe class="embed-responsive-item" src="img/nations.mp4"></iframe><br></div><h3 id="add-a-pause-to-the-final-frame-on-a-gif"><a name="add-a-pause-to-the-final-frame-on-a-gif" href="#add-a-pause-to-the-final-frame-on-a-gif"></a>Add a pause to the final frame on a GIF</h3><p>When making GIFs, it is often a good idea to add a longer pause on the final frame before the animation repeats. You can do this with the following code:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># increase delay on final frame
system(&quot;convert nations.gif \\( +clone -set delay 300 \\) +swap +delete  nations_with_pause.gif&quot;)
</code></pre>"><span class="hljs-comment"># increase delay on final frame</span>
system(<span class="hljs-string">"convert nations.gif \\( +clone -set delay 300 \\) +swap +delete  nations_with_pause.gif"</span>)
</code></pre><p>This code uses the <code>system</code> function to send ImageMagick code to your wider computer system.</p><p><code>convert</code> is one of the main commands in ImageMagick, used to convert between image formats as well as to manipulate images in a variety of ways. Here, <code>delay 300</code> increases the delay on the final frame to 3 seconds.</p><p>Here is the revised GIF:</p><p><img src="img/nations_with_pause.gif" alt=""></p><h3 id="make-cumulative-animations-of-historical-global-average-temperature"><a name="make-cumulative-animations-of-historical-global-average-temperature" href="#make-cumulative-animations-of-historical-global-average-temperature"></a>Make cumulative animations of historical global average temperature</h3><p>For the Gapminder-style video, we displayed only the data for the year in question in each frame. In some cases, however, you may want to animate by adding data with each frame, and leaving the previously added data in place.</p><p>We will explore that now to make two animations of historical global temperature data from the National Oceanic and Atmospheric Administration (NOAA), similar to the video I made <a href="https://www.buzzfeed.com/peteraldhous/this-is-your-planet-on-co2">here</a>, and the GIF <a href="https://www.buzzfeed.com/peteraldhous/another-hottest-year">here</a>.</p><p>Navigate to NOAA’s Climate at a Glance <a href="https://www.ncdc.noaa.gov/cag/time-series/">time series page</a>, and set the menus like this:</p><p><img src="img/animations_2.jpg" alt=""></p><p>Scroll down to the data table, and hover over this icon:</p><p><img src="img/animations_3.jpg" alt=""></p><p>This is a link to download a CSV, but we can’t load it directly into R if we have its URL, so right-click and <code>Copy Link Address</code>.</p><p>Now we can load the data:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># load data
global_temp_annual &amp;lt;- read_csv(&quot;https://www.ncdc.noaa.gov/cag/time-series/global/globe/land_ocean/1/12/1880-2017.csv&quot;, skip = 4)
</code></pre>"><span class="hljs-comment"># load data</span>
global_temp_annual &lt;- read_csv(<span class="hljs-string">"https://www.ncdc.noaa.gov/cag/time-series/global/globe/land_ocean/1/12/1880-2017.csv"</span>, skip = <span class="hljs-number">4</span>)
</code></pre><p>The includes <code>skip = 4</code> because there are four rows in the file before the column headers.</p><p>The following code will draw a dot-and-line chart from the data:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># draw chart
ggplot(global_temp_annual, aes(x = Year, y = Value)) +
  geom_line(color = &quot;black&quot;) +
  geom_point(shape = 21, colour=&quot;black&quot;, aes(fill = Value), size=5, stroke=1) +
  theme_minimal(base_size = 16) +
  scale_fill_distiller(palette = &quot;RdYlBu&quot;, limits = c(-2,2), guide = FALSE) +
  xlab(&quot;&quot;) +
  ylab(&quot;Diff. from 1901-2000 average (ºC)&quot;)
</code></pre>"><span class="hljs-comment"># draw chart</span>
ggplot(global_temp_annual, aes(x = Year, y = Value)) +
  geom_line(color = <span class="hljs-string">"black"</span>) +
  geom_point(shape = <span class="hljs-number">21</span>, colour=<span class="hljs-string">"black"</span>, aes(fill = Value), size=<span class="hljs-number">5</span>, stroke=<span class="hljs-number">1</span>) +
  theme_minimal(base_size = <span class="hljs-number">16</span>) +
  scale_fill_distiller(palette = <span class="hljs-string">"RdYlBu"</span>, limits = c(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), guide = <span class="hljs-literal">FALSE</span>) +
  xlab(<span class="hljs-string">""</span>) +
  ylab(<span class="hljs-string">"Diff. from 1901-2000 average (ºC)"</span>)
</code></pre><p>This should be the result:</p><p><img src="img/animations_4.png" alt=""></p><p>This code uses ColorBrewer’s <code>RdYlBu</code> palette, which runs from cool blues, through neutral yellows, to warm reds, fitting well to temperature data diverging from a central value.</p><p>The palette is applied with the function <code>scale_fill_distiller</code>. This and the function <code>scale_color_distiller</code> can be used to apply ColorBrewer sequential and diverging palettes in a smooth gradient to continuous variables, see <a href="https://www.rdocumentation.org/packages/ggplot2/versions/2.2.1/topics/scale_colour_brewer">here</a> for more. Setting <code>limits = c(-2,2)</code> applies the palette for values from -2 to +2 degrees C, ensuring that the neutral yellow at the middle of the diverging palette is applied to a value of zero.</p><p>As this is a dot-and-line chart, it includes both <code>geom_line</code> and <code>geom_point</code> layers. Notice that the <code>geom_point</code> function also defines a numbered <code>shape</code>: <code>21</code> is a circle with a filled area, see <a href="http://www.cookbook-r.com/Graphs/Shapes_and_line_types/">here</a> for other options. By using this shape, we can set the outline <code>color</code> to black and then use an <code>aes</code> mapping to <code>fill</code> it with color from the selected palette, according to the values for the <code>annual</code> variable.</p><p>To animate this chart, adding a year of data with each frame, use the following code:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># animation
global_temp_annual_chart &amp;lt;- ggplot(global_temp_annual, aes(x = Year, 
                                                           y = Value, 
                                                           frame = Year, 
                                                           cumulative = TRUE)) +
  geom_line(color = &quot;black&quot;) +
  geom_point(shape = 21, color = &quot;black&quot;, aes(fill = Value), size = 5, stroke = 1) +
  theme_minimal(base_size = 16) +
  scale_fill_distiller(palette = &quot;RdYlBu&quot;, limits = c(-2,2), guide = FALSE) +
  xlab(&quot;&quot;) +
  ylab(&quot;Diff. from 1901-2000 average (ºC)&quot;)

# save as video
gganimate(global_temp_annual_chart, &quot;warming_annual.mp4&quot;, ani.width = 800, ani.height = 450, interval = 0.1)
</code></pre>"><span class="hljs-comment"># animation</span>
global_temp_annual_chart &lt;- ggplot(global_temp_annual, aes(x = Year, 
                                                           y = Value, 
                                                           frame = Year, 
                                                           cumulative = <span class="hljs-literal">TRUE</span>)) +
  geom_line(color = <span class="hljs-string">"black"</span>) +
  geom_point(shape = <span class="hljs-number">21</span>, color = <span class="hljs-string">"black"</span>, aes(fill = Value), size = <span class="hljs-number">5</span>, stroke = <span class="hljs-number">1</span>) +
  theme_minimal(base_size = <span class="hljs-number">16</span>) +
  scale_fill_distiller(palette = <span class="hljs-string">"RdYlBu"</span>, limits = c(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), guide = <span class="hljs-literal">FALSE</span>) +
  xlab(<span class="hljs-string">""</span>) +
  ylab(<span class="hljs-string">"Diff. from 1901-2000 average (ºC)"</span>)

<span class="hljs-comment"># save as video</span>
gganimate(global_temp_annual_chart, <span class="hljs-string">"warming_annual.mp4"</span>, ani.width = <span class="hljs-number">800</span>, ani.height = <span class="hljs-number">450</span>, interval = <span class="hljs-number">0.1</span>)
</code></pre><p>This time, the initial <code>ggplot</code> function also contains the code <code>cumulative = TRUE</code>, which adds one year of data with each frame, and leaves the previously added data in place.</p><p>This should be the result:</p><div class="embed-responsive embed-responsive-16by9"><br>    <iframe class="embed-responsive-item" src="img/warming_annual.mp4"></iframe><br></div><p>Now we’ll make an animation showing a line for each year, drawn theough the temperature values for each month.</p><p>Back at NOAA’s climate time series page, select these menu options:</p><p><img src="img/animations_5.jpg" alt=""></p><p>Grab the URL for this data, as before, and load:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># load data
global_temp_monthly &amp;lt;- read_csv(&quot;https://www.ncdc.noaa.gov/cag/time-series/global/globe/land_ocean/all/12/1880-2017.csv&quot;, skip = 4)
</code></pre>"><span class="hljs-comment"># load data</span>
global_temp_monthly &lt;- read_csv(<span class="hljs-string">"https://www.ncdc.noaa.gov/cag/time-series/global/globe/land_ocean/all/12/1880-2017.csv"</span>, skip = <span class="hljs-number">4</span>)
</code></pre><p>The first few rows should look like this:</p><p><img src="img/animations_6.jpg" alt=""></p><p>To animate this data by year, but plot each by month as if all the months were in the same year, we need to process the data as follows:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># process data
global_temp_monthly &amp;lt;- global_temp_monthly %&amp;gt;%
  rename(Yr_Mo = Year) %&amp;gt;%
  mutate(Year = as.integer(substr(Yr_Mo,1,4)),
         Date = as.Date(paste0(substr(Yr_Mo,1,4),
                               &quot;-&quot;,
                               substr(Yr_Mo,5,6),
                               &quot;-01&quot;)),
         Date_2017 = as.Date(paste0(&quot;2017-&quot;,
                                    substr(Yr_Mo,5,6),
                                    &quot;-01&quot;)))
</code></pre>"><span class="hljs-comment"># process data</span>
global_temp_monthly &lt;- global_temp_monthly %&gt;%
  rename(Yr_Mo = Year) %&gt;%
  mutate(Year = as.integer(substr(Yr_Mo,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)),
         Date = as.Date(paste0(substr(Yr_Mo,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>),
                               <span class="hljs-string">"-"</span>,
                               substr(Yr_Mo,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>),
                               <span class="hljs-string">"-01"</span>)),
         Date_2017 = as.Date(paste0(<span class="hljs-string">"2017-"</span>,
                                    substr(Yr_Mo,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>),
                                    <span class="hljs-string">"-01"</span>)))
</code></pre><p>This code renames <code>Year</code>, which actually contains year and numeric month, to <code>Yr_Mo</code>. Then it uses the function <code>substr</code> to pull out the first four digits the create a new <code>Year</code> variable. It then creates two date columns, setting the date to the 1st of each month, and in the second case places all the dates in 2017. This sleight of hand is necessary to plot them as dates and have the lines stack up over one another. We can discuss why in class.</p><p>This code draws a chart with a line for every year:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># draw chart
ggplot(global_temp_monthly, aes(x=Date_2017, 
                                y=Value, 
                                color = Value, 
                                group = Year)) +
  geom_line(size = 0.5, alpha = 0.5) + 
  theme_dark(base_size = 20) +
  scale_color_distiller(palette = &quot;RdYlBu&quot;, limits = c(-2,2), guide = FALSE) +
  ylab(&quot;Diff. from C20th average (ºC)&quot;) +
  xlab(&quot;&quot;) +
  scale_x_date(date_labels = &quot;%b&quot;,
               date_breaks = &quot;month&quot;) +
  theme(panel.grid.minor = element_blank())
</code></pre>"><span class="hljs-comment"># draw chart</span>
ggplot(global_temp_monthly, aes(x=Date_2017, 
                                y=Value, 
                                color = Value, 
                                group = Year)) +
  geom_line(size = <span class="hljs-number">0.5</span>, alpha = <span class="hljs-number">0.5</span>) + 
  theme_dark(base_size = <span class="hljs-number">20</span>) +
  scale_color_distiller(palette = <span class="hljs-string">"RdYlBu"</span>, limits = c(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), guide = <span class="hljs-literal">FALSE</span>) +
  ylab(<span class="hljs-string">"Diff. from C20th average (ºC)"</span>) +
  xlab(<span class="hljs-string">""</span>) +
  scale_x_date(date_labels = <span class="hljs-string">"%b"</span>,
               date_breaks = <span class="hljs-string">"month"</span>) +
  theme(panel.grid.minor = element_blank())
</code></pre><p>In the <code>aes</code> mapping, it is necessary to use <code>group = Year</code> to ensure that a separate line is drawn for each year.</p><p>The code uses another <strong>ggplot2</strong> built-in theme, <code>theme_dark</code>, to make the lightly colored lines show up against a dark background. The second <code>theme</code> function removes some of the grid lines.</p><p><code>scale_x_date</code> sets the breaks for the data as monthly, and formats the date labels as the abbreviated month (Jan, Feb, etc). See what happens if you comment out this part of the code.</p><p>This code will create a cumulative animation of the data:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># animation
global_temp_monthly_chart &amp;lt;- ggplot(global_temp_monthly, aes(x=Date_2017, 
                                                             y=Value, 
                                                             color = Value, 
                                                             group = Year, 
                                                             frame = Year, 
                                                             cumulative = TRUE)) +
  geom_line(size = 0.5, alpha = 0.5) + 
  theme_dark(base_size = 20) +
  scale_color_distiller(palette = &quot;RdYlBu&quot;, limits = c(-2,2), guide = FALSE) +
  ylab(&quot;Diff. from C20th average (ºC)&quot;) +
  xlab(&quot;&quot;) +
  scale_x_date(date_labels = &quot;%b&quot;,
               date_breaks = &quot;month&quot;) +
  theme(panel.grid.minor = element_blank())

# save as GIF
gganimate(global_temp_monthly_chart, &quot;warming_monthly.gif&quot;, ani.width = 750, ani.height = 450,  interval = 0.1)
</code></pre>"><span class="hljs-comment"># animation</span>
global_temp_monthly_chart &lt;- ggplot(global_temp_monthly, aes(x=Date_2017, 
                                                             y=Value, 
                                                             color = Value, 
                                                             group = Year, 
                                                             frame = Year, 
                                                             cumulative = <span class="hljs-literal">TRUE</span>)) +
  geom_line(size = <span class="hljs-number">0.5</span>, alpha = <span class="hljs-number">0.5</span>) + 
  theme_dark(base_size = <span class="hljs-number">20</span>) +
  scale_color_distiller(palette = <span class="hljs-string">"RdYlBu"</span>, limits = c(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), guide = <span class="hljs-literal">FALSE</span>) +
  ylab(<span class="hljs-string">"Diff. from C20th average (ºC)"</span>) +
  xlab(<span class="hljs-string">""</span>) +
  scale_x_date(date_labels = <span class="hljs-string">"%b"</span>,
               date_breaks = <span class="hljs-string">"month"</span>) +
  theme(panel.grid.minor = element_blank())

<span class="hljs-comment"># save as GIF</span>
gganimate(global_temp_monthly_chart, <span class="hljs-string">"warming_monthly.gif"</span>, ani.width = <span class="hljs-number">750</span>, ani.height = <span class="hljs-number">450</span>,  interval = <span class="hljs-number">0.1</span>)
</code></pre><p>Again, we can increase the delay on the final frame of the GIF:</p><pre class="r hljs"><code class="R" data-origin="<pre><code class=&quot;R&quot;># increase delay on final frame
system(&quot;convert warming_monthly.gif \\( +clone -set delay 300 \\) +swap +delete  warming_monthly_with_pause.gif&quot;)
</code></pre>"><span class="hljs-comment"># increase delay on final frame</span>
system(<span class="hljs-string">"convert warming_monthly.gif \\( +clone -set delay 300 \\) +swap +delete  warming_monthly_with_pause.gif"</span>)
</code></pre><p>This should be the result:</p><p><img src="img/warming_monthly_with_pause.gif" alt=""></p><h3 id="further-reading/resources"><a name="further-reading/resources" href="#further-reading/resources"></a>Further reading/resources</h3><p><a href="http://www.imagemagick.org/Usage/">ImageMagick examples</a></p><p><a href="https://ffmpeg.org/ffmpeg.html">FFmpeg documentation</a></p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
